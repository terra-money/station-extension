import { Meta, Story, Canvas, Controls, ArgTypes, Description, Source } from '@storybook/addon-docs/blocks';
import Form from './Form';
import * as FormStories from './Form.stories';
import 'scss/storybookoverrides.scss';


<Meta title='Components/Form' of={FormStories} />

# Form
Form wrappers for inputs and buttons.
* Should be used with [useForm] from react-hook-form.

## Imports
```tsx
import Form, { FormArrow, FormGroup, FormItem } from './Form';
```

* `<Form>` Wraps a form with a submit button. Should be used with [useForm] from react-hook-form.
* `<FormItem>` Wraps an `<Input />` with a label and error message.
* `<FormGroup>` Groups an `<Input />` and a button together inline.
* `<FormArrow>` An arrow icon that points down. If `onClick` is provided, `<button>` will wrap the Icon.

## Usage
```tsx
  <Form onSubmit={handleSubmit(submit)}>
    {...}
    <FormItem // import from Form.tsx
      label={'Amount'}
      error={errors.amount?.message}  // errors from react-hook-form
    >
      <Input  // import from Input.tsx
        //*requires register() from react-hook-form*
        token={asset} // Asset comes from another imput not displayed here
        inputMode='decimal'
        placeholder='0.00'
      />
    </FormItem>
  </Form>
```

# Stories

## Form Example
* Wraps a form with a `<Submit />`. Should be used with [useForm] from react-hook-form.
* Note that some components, like `<Tx>`, have their own Submit buttons. In which case it's not required to use `<Submit />`.
<div className='story_with_source_below'>
  <Canvas>
    <Story id='components-form--full-form-example' />
  </Canvas>
  <Source code={`
    // Example from AddNetworkForm.tsx
    {...}

    /* form */
    const form = useForm<CustomNetwork>({ mode: 'onChange' })
    const { register, watch, handleSubmit, formState } = form
    const { errors, isValid } = formState
    const { preconfigure } = watch()

    const submit = (values: CustomNetwork) => {
      add(values)
      setNetwork(values.name)
      navigate('/')
    }

    return (
      <Form onSubmit={handleSubmit(submit)}>
        <FormItem label={t('Name')} error={errors.name?.message}>
          <Input
            {...register('name', {})}
            placeholder={mainnet.name}
            autoFocus
          />
        </FormItem>

        <FormItem label={t('Chain ID')} error={errors.chainID?.message}>
          <Input
            {...register('chainID', { required: true })}
            placeholder={mainnet.chainID}
          />
        </FormItem>

        <FormItem label={t('LCD')} error={errors.lcd?.message}>
          <Input
            {...register('lcd', { required: true })}
            placeholder={mainnet.lcd}
          />
        </FormItem>

        <Checkbox {...register('preconfigure')} checked={preconfigure}>
          {t('Preconfigure accounts')}
        </Checkbox>

        <Submit disabled={!isValid} />
      </Form>
    )
  `} />
</div>

## FormGroup
* Groups an `<Input />` and a button together inline.
<div className='story_with_source_below'>
  <Canvas>
    <Story id='components-form--group' />
  </Canvas>
  <Source code={`
    <FormItem label='Amount'>
      {fields.map((_, i) => (
        <FormGroup
          button={
            fields.length - 1 === i
              ? {
                  onClick: () => addField(),
                  children: <AddIcon style={{ fontSize: 18 }} />,
                }
              : {
                  onClick: () => removeField(i),
                  children: <RemoveIcon style={{ fontSize: 18 }} />,
                }
          }
          key={i}
        >
          <Input
            inputMode='decimal'
            placeholder='0.00'
            selectBefore={
              <Select before>
                <option value='USD'>USD</option>
                <option value='EUR'>EUR</option>
                <option value='GBP'>GBP</option>
              </Select>
            }
          />
        </FormGroup>
      ))}
    </FormItem>
  `} />
</div>

## FormItem
This is the wrapper around an input item that provides the possibility of a label and error message.
<div className='story_with_source_below'>
  <Canvas>
    <Story id='components-form--item' />
  </Canvas>
  <Source code={`
    <FormItem
      label='Username'
      error='This field is required'
      extra='Optional'
    >
      <Input placeholder='This is an input'/>
    </FormItem>
  `} />
</div>

## FormArrow
* An arrow icon that points down. If `onClick` is provided, `<button>` will wrap the Icon.
<div className='story_with_source_below'>
  <Canvas>
    <Story id='components-form--arrow' />
  </Canvas>
  <Source code={`
    <FormArrow />
  `} />
</div>