import {
  Meta,
  Canvas,
  Source,
} from "@storybook/blocks";
import { RequiredText } from "../../../DocsHelpers.tsx";
import * as AssetSelectorStories from "./AssetSelector.stories.tsx";
import "scss/storybookoverrides.scss";

<Meta title="Components/Inputs/AssetSelector" />

# Asset Selectors

##### This is for selecting assets on the Swap page.
`To` and `From` are slightly different.

## AssetSelector `From` Props
- **`setValue`** - <RequiredText /> - `(value: string) => void` - from `react-hook-form` Controls what happens when the input value changes.
- **`walletAmount`** - <RequiredText /> - `number` - The value of the selected token in a users wallet.
- **`handleMaxClick`** - <RequiredText /> - `() => void` - Function on what to do when the max button is clicked.
- **`symbol`** - <RequiredText /> - `string` - The symbol of the token.
- **`onSymbolClick`** - <RequiredText /> - `() => void` - Controls what happens when the token dropdown is clicked.
- **`tokenIcon`** - <RequiredText /> - `string` - The icon of the token.
- **`chainIcon`** - <RequiredText /> - `string` - The icon of the selected tokens chain.
- **`chainName`** - <RequiredText /> - `string` - The name of the selected tokens chain.
- **`amountInputAttrs`** - <RequiredText /> - `InputHTMLAttributes<HTMLInputElement>` - Attributes from react-hook-form or others.
- **`amount`** - <RequiredText /> - `number` - The amount a user will get on this token based off of the "To" input.
- **`currencyAmount`** - <RequiredText /> - `number` - The price of the token converted to currency.
- **`currencySymbol`** - <RequiredText /> - `string` - The symbol of the currency.

## AssetSelector `To` Props
- **`walletAmount`** - <RequiredText /> - `number` - The value of the selected token in a users wallet.
- **`symbol`** - <RequiredText /> - `string` - The symbol of the token.
- **`tokenIcon`** - <RequiredText /> - `string` - The icon of the token.
- **`onSymbolClick`** - <RequiredText /> - `() => void` - Controls what happens when the token dropdown is clicked.
- **`chainIcon`** - <RequiredText /> - `string` - The icon of the selected tokens chain.
- **`chainName`** - <RequiredText /> - `string` - The name of the selected tokens chain.
- **`amount`** - <RequiredText /> - `number` - The amount a user will get on this token based off of the "From" input.
- **`currencyAmount`** - <RequiredText /> - `number` - The price of the token converted to currency.
- **`currencySymbol`** - <RequiredText /> - `string` - The symbol of the currency.

## Import
```jsx
import { AssetSelectorFrom, AssetSelectorTo } from "station-ui";
```

## Stories

## Example
An example of both the `From` and `To` Asset Selectors like they would be on the Swap page.
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.Example} />
  <Source code={`
    const [fromSymbol, setFromSymbol] = useState("LUNA")
const [toSymbol, setToSymbol] = useState("axlUSDC")
const [assetModalOpen, setAssetModalOpen] = useState(false)
const [direction, setDirection] = useState("")

const { register, handleSubmit, watch, setValue } = useForm()
const onSubmit = handleSubmit(data => console.log(data))
const toAmount = parseFloat(watch("fromAmount")) * tokenPrices[fromSymbol] / tokenPrices[toSymbol]

const handleFromSymbolClick = (direction: string) => {
  setAssetModalOpen(!assetModalOpen)
  setDirection(direction)
}

const options = [
  { value: "terra", label: "Terra" },
  { value: "axelar", label: "Axelar" },
  { value: "carbon", label: "Carbon" },
  { value: "cosmos", label: "Cosmos" },
  { value: "crescent", label: "Crescent" },
  { value: "juno", label: "Juno" },
  { value: "mars", label: "Mars" },
]

const handleTokenSelection = (token: string) => {
  if (direction === "from") {
    setFromSymbol(token)
    setAssetModalOpen(!assetModalOpen)
    setDirection("")
  } else if (direction === "to") {
    setToSymbol(token)
    setAssetModalOpen(!assetModalOpen)
    setDirection("")
  }
}

const maxClick = () => {
  setValue("fromAmount", walletBalance[fromSymbol])
  // setValue("currencyAmount", parseFloat(walletBalance[fromSymbol]) * tokenPrices[fromSymbol])
}

return (
  <>
    <Modal
      isOpen={assetModalOpen}
      onRequestClose={() => setAssetModalOpen(false)}
      title="Select Asset"
    >
      <FlexColumn gap={24} style={{ width: "100%" }}>
        <InputWrapper label="Chains">
          <StandardDropdown
            options={options}
            onChange={() => {}}
            value="terra"
          />
        </InputWrapper>

        <SectionHeader
          title="Tokens"
          withLine
        />

        <InputWrapper label="Search Tokens">
          <Input
            placeholder="Search Tokens"
            onChange={() => {}}
          />
        </InputWrapper>

        <div style={{ width: "100%", display: "flex", flexDirection: "column", gap: "24px" }}>
          {Object.keys(tokensBySymbol).map((token, index) => (
            <TokenSingleChainListItem
              key={index}
              priceNode={<span>$ {tokenPrices[token]}</span>}
              tokenImg={tokensBySymbol[token].tokenIcon}
              symbol={tokensBySymbol[token].symbol}
              amountNode={<span>{walletBalance[token]}</span>}
              chain={{ icon: tokensBySymbol[token].chainIcon, label: tokensBySymbol[token].chainName }}
              onClick={() => handleTokenSelection(token)}
            />
          ))}
        </div>

      </FlexColumn>
    </Modal>
    <form onSubmit={onSubmit}>
      <AssetSelectorFrom
        setValue={setValue}
        walletAmount={parseFloat(walletBalance[fromSymbol])}
        handleMaxClick={maxClick}
        symbol={fromSymbol}
        onSymbolClick={() => handleFromSymbolClick("from")}
        tokenIcon={tokensBySymbol[fromSymbol].tokenIcon}
        chainIcon={tokensBySymbol[fromSymbol].chainIcon}
        chainName={tokensBySymbol[fromSymbol].chainName}
        amountInputAttrs={{...register("fromAmount", { required: true, valueAsNumber: true })}}
        amount={watch("fromAmount") || 0}
        currencyAmount={tokenPrices[fromSymbol]}
        currencySymbol={"$"}
      />
      <br />
      <br />
      <br />
      <AssetSelectorTo
        walletAmount={parseFloat(walletBalance[toSymbol])}
        symbol={toSymbol}
        tokenIcon={tokensBySymbol[toSymbol].tokenIcon}
        onSymbolClick={() => handleFromSymbolClick("to")}
        chainIcon={tokensBySymbol[toSymbol].chainIcon}
        chainName={tokensBySymbol[toSymbol].chainName}
        amount={toAmount || 0}
        currencyAmount={tokenPrices[toSymbol]}
        currencySymbol={"$"}
      />
    </form>
  </>
)
  `} />
</div>

## From
Just the `From` Asset Selector.
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.From} />
  <Source code={`
    const [fromSymbol, setFromSymbol] = useState("LUNA")
const [toSymbol, setToSymbol] = useState("axlUSDC")
const [assetModalOpen, setAssetModalOpen] = useState(false)
const [direction, setDirection] = useState("")

const { register, handleSubmit, watch, setValue } = useForm()
const onSubmit = handleSubmit(data => console.log(data))
const toAmount = parseFloat(watch("fromAmount")) * tokenPrices[fromSymbol] / tokenPrices[toSymbol]

const handleFromSymbolClick = (direction: string) => {
  setAssetModalOpen(!assetModalOpen)
  setDirection(direction)
}

const maxClick = () => {
  setValue("fromAmount", walletBalance[fromSymbol])
  // setValue("currencyAmount", parseFloat(walletBalance[fromSymbol]) * tokenPrices[fromSymbol])
}

return (
  <form onSubmit={onSubmit}>
    <AssetSelectorFrom
      setValue={setValue}
      walletAmount={parseFloat(walletBalance[fromSymbol])}
      handleMaxClick={maxClick}
      symbol={fromSymbol}
      onSymbolClick={() => handleFromSymbolClick("from")}
      tokenIcon={tokensBySymbol[fromSymbol].tokenIcon}
      chainIcon={tokensBySymbol[fromSymbol].chainIcon}
      chainName={tokensBySymbol[fromSymbol].chainName}
      amountInputAttrs={{...register("fromAmount", { required: true, valueAsNumber: true })}}
      amount={watch("fromAmount") || 0}
      currencyAmount={tokenPrices[fromSymbol]}
      currencySymbol={"$"}
    />
  </form>
)
  `} />
</div>

## ToEmpty
Just the `To` Asset Selector.
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.ToEmpty} />
  <Source code={`
    const toSymbol = "axlUSDC"
const toAmount = 0

return (
  <AssetSelectorTo
    walletAmount={parseFloat(walletBalance[toSymbol])}
    symbol={toSymbol}
    tokenIcon={tokensBySymbol[toSymbol].tokenIcon}
    onSymbolClick={() => {}}
    chainIcon={tokensBySymbol[toSymbol].chainIcon}
    chainName={tokensBySymbol[toSymbol].chainName}
    amount={toAmount || 0}
    currencyAmount={tokenPrices[toSymbol]}
    currencySymbol={"$"}
  />
)
  `} />
</div>

## To
Just the `To` Asset Selector.
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.To} />
  <Source code={`
    const toSymbol = "axlUSDC"
const toAmount = 123786

return (
  <AssetSelectorTo
    walletAmount={parseFloat(walletBalance[toSymbol])}
    symbol={toSymbol}
    tokenIcon={tokensBySymbol[toSymbol].tokenIcon}
    onSymbolClick={() => {}}
    chainIcon={tokensBySymbol[toSymbol].chainIcon}
    chainName={tokensBySymbol[toSymbol].chainName}
    amount={toAmount || 0}
    currencyAmount={tokenPrices[toSymbol]}
    currencySymbol={"$"}
  />
)
  `} />
</div>

## SendExample
`<AssetSelectorFrom />` used for Send
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.SendExample} />
  <Source code={`
    const [fromSymbol, setFromSymbol] = useState("LUNA")
const [assetModalOpen, setAssetModalOpen] = useState(false)

const { register, handleSubmit, watch, setValue, formState } = useForm({mode: "onChange"})
const onSubmit = handleSubmit(data => console.log(data))

const maxClick = () => {
  setValue("tokenAmount", walletBalance[fromSymbol])
  setValue("currencyAmount", parseFloat(walletBalance[fromSymbol]) * tokenPrices[fromSymbol])
}

const handleFromSymbolClick = () => {
  setAssetModalOpen(!assetModalOpen)
}

const options = [
  { value: "terra", label: "Terra" },
  { value: "axelar", label: "Axelar" },
  { value: "carbon", label: "Carbon" },
  { value: "cosmos", label: "Cosmos" },
  { value: "crescent", label: "Crescent" },
  { value: "juno", label: "Juno" },
  { value: "mars", label: "Mars" },
]

const handleTokenSelection = (token: string) => {
  setFromSymbol(token)
  setAssetModalOpen(!assetModalOpen)
}

return (
  <>
    <Modal
      isOpen={assetModalOpen}
      onRequestClose={() => setAssetModalOpen(false)}
      title="Select Asset"
    >
      <FlexColumn gap={24} style={{ width: "100%" }}>
        <InputWrapper label="Chains">
          <StandardDropdown
            options={options}
            onChange={() => {}}
            value="terra"
          />
        </InputWrapper>

        <SectionHeader
          title="Tokens"
          withLine
        />

        <InputWrapper label="Search Tokens">
          <Input
            placeholder="Search Tokens"
            onChange={() => {}}
          />
        </InputWrapper>

        <div style={{ width: "100%", display: "flex", flexDirection: "column", gap: "24px" }}>
          {Object.keys(tokensBySymbol).map((token, index) => (
            <TokenSingleChainListItem
              key={index}
              priceNode={<span>$ {tokenPrices[token]}</span>}
              tokenImg={tokensBySymbol[token].tokenIcon}
              symbol={tokensBySymbol[token].symbol}
              amountNode={<span>{walletBalance[token]}</span>}
              chain={{ icon: tokensBySymbol[token].chainIcon, label: tokensBySymbol[token].chainName }}
              onClick={() => handleTokenSelection(token)}
            />
          ))}
        </div>

      </FlexColumn>
    </Modal>
    <form onSubmit={onSubmit}>
      <AssetSelectorFrom
        setValue={setValue}
        walletAmount={parseFloat(walletBalance[fromSymbol])}
        handleMaxClick={maxClick}
        symbol={fromSymbol}
        onSymbolClick={handleFromSymbolClick}
        tokenIcon={tokensBySymbol[fromSymbol].tokenIcon}
        chainIcon={tokensBySymbol[fromSymbol].chainIcon}
        chainName={tokensBySymbol[fromSymbol].chainName}
        amountInputAttrs={{...register("tokenAmount", { required: true, valueAsNumber: true })}}
        amount={watch("tokenAmount") || 0}
        currencyAmount={tokenPrices[fromSymbol]}
        currencySymbol={"$"}
      />
    </form>
  </>
)
  `} />
</div>

## Skeleton
Loading skeleton for the `From` and `To` Asset Selector.
<div className="story_with_source_below">
  <Canvas of={AssetSelectorStories.Skeleton} />
  <Source code={`
    <AssetSelectorSkeleton />
  `} />
</div>

<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
